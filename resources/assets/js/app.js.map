{"version":3,"sources":["app.ts"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["/// <reference path=\"../types/semantic-ui.d.ts\" />\n/// <reference path=\"../types/semantic-ui-calendar.d.ts\" />\n\n\nclass App {\n    error(message: string) {\n        console.error(message);\n        console.trace();\n        alertify.error(message);\n    };\n\n    success(message: string) {\n        alertify.success(message);\n    };\n\n    redirect(location: string, method: string, args?: any) {\n        var form = $('<form></form>');\n        form.attr('method', method);\n        form.attr('action', location);\n\n        if (!args)\n            args = {};\n\n        args['_token'] = $('meta[name=\"csrf-token\"]').attr('content');\n\n        $.each(args, function(key, value) {\n            var field = $('<input></input>');\n\n            field.attr('type', 'hidden');\n            field.attr('name', key);\n            field.attr('value', value);\n\n            form.append(field);\n        });\n        $(form).appendTo('body').submit();\n    };\n\n    redirectPost(location: string, args?: any) {\n        this.redirect(location, 'post', args);\n    };\n\n    redirectPut(location: string, args?: any) {\n        if (!args)\n            args = {};\n        this.redirect(location, 'post', $.extend({}, args, {'_method': 'put'}));\n    };\n\n    redirectDelete(location: string, args?: any) {\n        if (!args)\n            args = {};\n        this.redirect(location, 'post', $.extend({}, args, {'_method': 'delete'}));\n    }\n}\n\n$.ajaxSetup({\n    headers: {\n        'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n    }\n});\n\n$(function() {\n    var app = new App;\n\n    // Date picker\n    $('.datepicker').calendar({\n        type: 'date',\n    });\n\n    function deleteModal(e: JQueryEventObject, url: string, modalId: string, cancelId: string, approveId: string) {\n        var $modal = $(modalId);\n\n        // Cancel deletion\n        $modal\n            .find(cancelId)\n            .off()\n            .on('click', function() {\n                $modal.modal('hide');\n            });\n\n        // Redirect user to delete url\n        $modal\n            .find(approveId)\n            .off()\n            .on('click', function() {\n                app.redirectDelete(url);\n            });\n\n        // Show confirmation dialog\n        $modal.modal('show');\n\n        return false;\n    }\n\n    $('.key-delete').on('click', function(e) {\n        deleteModal(e, $(this).attr('data-url'), '#confirm-key-delete', '#confirm-key-delete-cancel', '#confirm-key-delete-approve');\n    });\n\n    $('.repository-delete').on('click', function(e) {\n        deleteModal(e, $(this).attr('data-url'), '#confirm-repository-delete', '#confirm-repository-delete-cancel', '#confirm-repository-delete-approve');\n    });\n\n    // Dashboard\n    var $keyStoreModal = $('#key-add').modal({\n        onApprove: function() {\n            $(this).find('form').submit();\n            return false;\n        }\n    });\n\n    $('.key-add').on('click', function(e) {\n        // Show key creation dialog\n        $keyStoreModal.modal('show');\n\n        return false;\n    });\n\n    // Repositories\n    var $repositoryStoreModal = $('#repository-add').modal({\n        onApprove: function() {\n            $(this).find('form').submit();\n            return false;\n        }\n    });\n\n    $('.repository-add').on('click', function(e) {\n        console.debug('Add new repository');\n\n        // Show repository creation dialog\n        $repositoryStoreModal.modal('show');\n\n        return false;\n    });\n\n    // User\n    var $userAddModal = $('#user-add').modal({\n        onApprove: function() {\n            $(this).find('form').submit();\n            return false;\n        }\n    });\n\n    $('.user-add').on('click', function(e) {\n        // Show key creation dialog\n        $userAddModal.modal('show');\n\n        return false;\n    });\n\n    $('.modal form').on('submit', function(e) {\n        var $form = $(this);\n        var $submitButton = $form.find('button[type=\"submit\"]');\n\n        $form.addClass('loading');\n\n        $.ajax({\n            type: $form.attr('method'),\n            url: $form.attr('action'),\n            data: $form.serialize(),\n            success: function(data) {\n                $form.removeClass('loading');\n\n                if (data && data.redirect) {\n                    window.location.href = data.redirect;\n                } else {\n                    $form.closest('.modal').modal('hide');\n                    app.success('Erfolgreich gespeichert.');\n                }\n            },\n            error: function(err) {\n                $form.removeClass('loading');\n\n                if (err.status === 422) {\n                    var errors = JSON.parse(err.responseText);\n                    if (!errors) {\n                        app.error('Es ist ein Fehler beim speichern aufgetreten!');\n                        return false;\n                    }\n\n                    var $messageContainer = $form.find('.message');\n\n                    // Remove previous error classes and messages\n                    $form.find('.error').removeClass('error');\n                    $messageContainer.find('li').remove();\n\n                    for (var field in errors) {\n                        if (!errors.hasOwnProperty(field))\n                            continue;\n\n                        var $container = $form\n                            .find('[name=\"' + field + '\"]')\n                            .parent();\n\n                        for (var i = 0; i < errors[field].length; i++) {\n                            var message = errors[field][i];\n                            $container.addClass('error');\n                            $messageContainer.append('<li>' + message + '</li>');\n                        }\n                    }\n                } else {\n                    app.error('Es ist ein unbekannter Fehler beim speichern aufgetreten!');\n                    return false;\n                }\n            }\n        })\n\n        return false;\n    });\n});\n"]}